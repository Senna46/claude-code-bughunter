# Docker Compose for Claude Code BugHunter
# Mounts gh and claude auth configs from the host.
# Persists state DB and cloned repos in a named volume.

services:
  bughunter:
    build: .
    container_name: claude-code-bughunter
    restart: unless-stopped
    env_file: .env
    environment:
      - BUGHUNTER_WORK_DIR=/data/repos
      - BUGHUNTER_DB_PATH=/data/db/state.db
    volumes:
      # Persist state and cloned repos
      - bughunter-data:/data

      # Mount gh CLI auth (read-only)
      # On Linux: hosts.yml contains the token, file mount is sufficient
      # On macOS: hosts.yml exists but keyring holds the token, GH_TOKEN env var is required
      - ${HOME}/.config/gh:/root/.config/gh:ro

      # Mount claude CLI auth (read-write: claude CLI writes debug/stats during operation)
      - ${HOME}/.claude:/root/.claude

volumes:
  bughunter-data:
